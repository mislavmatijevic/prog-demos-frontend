<p-dialog header="Prijavi se ili registriraj" [(visible)]="loginDialogVisible" [modal]="true"
    [style]="{ width: '30rem' }">
    <span class="p-text-secondary">Kako bih osigurao proces testiranja tvog rješenja, zamolit ću te da se
        prvo prijaviš.</span>
    <app-login (loginSuccessful)="handleLoginSuccessful()"></app-login>
    <p-divider align="center" type="dotted">
        <b>ILI</b>
    </p-divider>
    <span class="p-text-secondary">Registriraj se, testiraj svoja rješenja odmah tu na stranici te uspoređuj svoja
        rješenja s ostalima.</span>
    <app-register (registrationSuccessful)="handleRegistrationSuccessful()"></app-register>
</p-dialog>
<div class="task__wrapper">
    <div class="task__wrapper-info__wrapper" *ngIf="task; else loadingTask"
        [ngStyle]="{'width': maximizeCodeHeight ? '0%' : '50%', 'padding': maximizeCodeHeight ? '0' : '20px 20px'}">
        <h2>{{task.name}}</h2>
        <ul>
            <li>Ulaz: {{task.input}}</li>
            <li>Izlaz: {{task.output}}</li>
        </ul>
        <h2>Primjer:</h2>
        <div class="console-output">
            <pre>{{task.inputOutputExample|newline}}</pre>
        </div>
    </div>
    <ng-template #loadingTask>
        <div class="loading-spinner">
            <p-progressSpinner ariaLabel="loading" />
        </div>
    </ng-template>
    <div class="task__wrapper-input__wrapper">
        <div class="task__wrapper-input__wrapper-controls-top">
            <p-button (onClick)="expandCode()" text="true" icon="pi pi-code"
                [pTooltip]="maximizeCodeHeight ? 'Prikaži zadatak' : 'Fokusiraj kod'" tooltipPosition="bottom" />
            <p-button (onClick)="copyCode()" text="true" icon="pi pi-copy" pTooltip="Kopiraj cijeli kod"
                tooltipPosition="bottom" />
        </div>

        <app-editor *ngIf="mainCode !== undefined" (onEditorReady)="onMainEditorReady()" [(code)]="mainCode"
            [isBeingBitcoded]="isBeingTestedRemotely" [bitCode]="bitCode"
            [ngStyle]="{'width': maximizeCodeHeight ? '100%' : 'initial'}" />

        <div *ngIf="codeHelpShown && mainCode !== undefined">
            <app-editor [isDiffEditor]="true" [originalCode]="helpPreviousCode" [(comparedCode)]="helpSuggestionCode"
                [ngStyle]="{'width': maximizeCodeHeight ? '100%' : 'initial'}" />
        </div>

        <div *ngIf="!mainEditorReady" class="loading-spinner loading-spinner-code">
            <p-progressSpinner ariaLabel="loading" />
        </div>

        <div class="task__wrapper-input__wrapper-controls-bottom">
            <p-button *ngIf="helpButtonRageTolerance != 0" rounded="true"
                [icon]="codeHelpShown ? 'pi pi-times' : 'pi pi-lightbulb'" (onClick)="toggleHelp()"
                [pTooltip]="codeHelpShown ? 'Zatvori pomoć' : 'Pomozi mi!'" tooltipPosition="top" severity="info" />
            <p-button rounded="true" icon="pi pi-face-smile" pTooltip="Motiviraj me!" tooltipPosition="top"
                severity="help" />
            <p-button [ngStyle]="{'visibility': isBeingTestedRemotely ? 'hidden' : 'visible' }" rounded="true"
                icon="pi pi-play" pTooltip="Testiraj!" (onClick)="executeCode()" tooltipPosition="top"
                severity="contrast" />
        </div>
    </div>
</div>
<p-overlayPanel>
</p-overlayPanel>